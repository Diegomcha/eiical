# 📅 EIICAL

**EIICAL** is an API wrapper for the EII Schedule webpage, offering enhanced features such as iCal export, custom group-based schedules, and flexible group management for users.

---

## 📚 Route Variables

| Variable     |  Format   | Example              | Description         |
| ------------ | :-------: | -------------------- | ------------------- |
| **Year**     |   `y1`    | `23` (2023-2024)     | Academic year       |
| **Semester** |    `x`    | `1` (First semester) | Semester number     |
| **Username** | `UOxxxxx` | `UO294054`           | University username |

---

## 🚦 API Endpoints

### 🔗 Official

- **All Users:**

  ```
  https://eiical.diegomcha.workers.dev/official/{y1}/{x}
  ```

  Redirects to the official page listing all users and their schedules.

- **Single User:**

  ```
  https://eiical.diegomcha.workers.dev/official/{y1}/{x}/{UOxxxxx}[?addGroup={g}&ignoreGroup={g}]
  ```

  Redirects to the official page showing a specific user's schedule.

- **Custom:**

  ```
  https://eiical.diegomcha.workers.dev/official/{y1}/{x}/custom?group={g}&group={g}...
  ```

  Redirects to the official page showing a schedule for a hypothetical user with specified groups.

---

### 📋 Table

- **Single User:**

  ```
  https://eiical.diegomcha.workers.dev/table/{y1}/{x}/{UOxxxxx}[?addGroup={g}&ignoreGroup={g}]
  ```

  Displays the selected user's schedule in a table format.

- **Custom:**

  ```
  https://eiical.diegomcha.workers.dev/table/{y1}/{x}/custom?group={g}&group={g}...
  ```

  Displays a table-format schedule for a hypothetical user with specified groups.

---

### 📄 CSV

- **Single User:**

  ```
  https://eiical.diegomcha.workers.dev/csv/{y1}/{x}/{UOxxxxx}[?addGroup={g}&ignoreGroup={g}]
  ```

  Downloads the user's calendar in CSV format, as generated by the official page.

- **Custom:**

  ```
  https://eiical.diegomcha.workers.dev/csv/{y1}/{x}/custom?group={g}&group={g}...
  ```

  Downloads a CSV calendar for a hypothetical user with specified groups.

---

### 📆 iCal

- **Single User:**

  ```
  https://eiical.diegomcha.workers.dev/ical/{y1}/{x}/{UOxxxxx}[?addGroup={g}&ignoreGroup={g}&alert={a}]
  ```

  Downloads the user's calendar in iCal format, generated from the official CSV. This calendar can be subscribed to in calendar applications.

- **Custom:**

  ```
  https://eiical.diegomcha.workers.dev/ical/{y1}/{x}/custom?group={g}&group={g}...[&alert={a}]
  ```

  Downloads an iCal calendar for a hypothetical user with specified groups. This calendar can be subscribed to in calendar applications.

---

## 🛠️ Query Parameters

Customize the schedule output for any "Single User" endpoint using these query parameters:

> [!IMPORTANT]
> The `alert` parameter is only available for **iCal** endpoints (both **Single User** and **Custom**).
>
> The `group` parameter is exclusive for the custom route. It is mandatory.

> [!NOTE]
> You can include multiple `addGroup`, `ignoreGroup`, `alert`, or `group` parameters in the query string.

| Parameter     |          Format          | Example    | Description                                                     |
| ------------- | :----------------------: | ---------- | --------------------------------------------------------------- |
| `addGroup`    | `xxxx.{T/S/L/TG}.(I-)?y` | `CVVS.T.1` | Adds a group to the user's schedule                             |
| `ignoreGroup` | `xxxx.{T/S/L/TG}.(I-)?y` | `IR.S.2`   | Removes a group from the user's schedule                        |
| `alert`       |          Number          | `10`       | Sets an alert in minutes before event (**iCal endpoints only**) |
| `group`       | `xxxx.{T/S/L/TG}.(I-)?y` | `RI.TG.1`  | Specifies a group for the schedule (**Custom endpoints only**)  |

### Example

This route gets the schedule in ical format for user `UO294054` for academic year `23` (2023-2024), semester `1`. You can further customize the schedule by adding or removing groups and, for iCal endpoints, setting event alerts:

```
https://eiical.diegomcha.workers.dev/ical/23/1/UO294054?addGroup=CVVS.T.1&ignoreGroup=CVVS.T.2&alert=0&alert=15
```

**Query parameters:**

- `addGroup=CVVS.T.1`: Include group `CVVS.T.1` in the schedule.
- `ignoreGroup=CVVS.T.2`: Exclude group `CVVS.T.2` from the schedule.
- `alert=0` and `alert=15`: _(iCal only)_ Add alerts for each event at the start time and 15 minutes before.

These options let you tailor the schedule output to your needs.
